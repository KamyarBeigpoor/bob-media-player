<Window x:Class="BobMediaPlayer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
        Title="BOB MEDIA PLAYER"
        Height="700"
        Width="1000"
        MinHeight="500"
        MinWidth="1100"
        Background="{StaticResource DarkBackground}"
        WindowStartupLocation="CenterScreen"
        AllowDrop="True"
        Drop="Window_Drop"
        FontFamily="Consolas"
        KeyDown="Window_KeyDown"
        WindowStyle="None"
        AllowsTransparency="False"
        BorderBrush="{StaticResource DarkBackground}"
        BorderThickness="0"
        UseLayoutRounding="True"
        SnapsToDevicePixels="True">

    <!-- WindowChrome for Windows 11 compatibility -->
    <shell:WindowChrome.WindowChrome>
        <shell:WindowChrome
            CaptionHeight="0"
            CornerRadius="0"
            GlassFrameThickness="0"
            NonClientFrameEdges="None"
            ResizeBorderThickness="0"
            UseAeroCaptionButtons="False"/>
    </shell:WindowChrome.WindowChrome>

    <Window.InputBindings>
        <KeyBinding Key="F11" Command="{Binding ToggleFullscreenCommand}"/>
        <KeyBinding Key="Escape" Command="{Binding ExitFullscreenCommand}"/>
    </Window.InputBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Media Display Area -->
        <Grid Grid.Row="0" x:Name="MediaDisplayGrid">

            <!-- Custom Title Bar -->
            <Border x:Name="TitleBar"
                   Background="{StaticResource DarkSecondary}"
                   BorderBrush="Transparent"
                   BorderThickness="0"
                   Height="40"
                   VerticalAlignment="Top"
                   Panel.ZIndex="1000"
                   MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid Margin="15,0">
                    <TextBlock Text="BOB MEDIA PLAYER"
                              Foreground="{StaticResource AccentColor}"
                              FontSize="11"
                              FontWeight="Bold"
                              FontFamily="Consolas"
                              VerticalAlignment="Center"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button x:Name="LibraryButton"
                               Content="[ LIBRARY ]"
                               Style="{StaticResource TechButton}"
                               Click="OpenLibrary_Click"
                               Padding="12,8"
                               Margin="0,0,8,0"
                               FontSize="9"
                               FontFamily="Consolas"
                               IsEnabled="True"/>
                        <Button x:Name="SettingsButton"
                               Content="[ SETTINGS ]"
                               Style="{StaticResource TechButton}"
                               Click="ToggleSettings_Click"
                               Padding="12,8"
                               Margin="0,0,8,0"
                               FontSize="9"
                               FontFamily="Consolas"
                               IsEnabled="True"/>
                        <Button Content="_"
                               Style="{StaticResource ModernButton}"
                               Click="Minimize_Click"
                               Padding="8,0"
                               Margin="0,0,8,0"
                               FontSize="16"
                               FontFamily="Consolas"
                               Width="32"
                               Height="32"/>
                        <Button Content="X"
                               Style="{StaticResource ModernButton}"
                               Click="Close_Click"
                               Padding="8,0"
                               FontSize="14"
                               FontFamily="Consolas"
                               Width="32"
                               Height="32"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Settings Bar -->
            <Border x:Name="SettingsBar"
                   Background="{StaticResource DarkTertiary}"
                   BorderBrush="Transparent"
                   BorderThickness="0"
                   Height="35"
                   VerticalAlignment="Top"
                   Margin="0,40,0,0"
                   Panel.ZIndex="999"
                   Visibility="Collapsed">
                <StackPanel Orientation="Horizontal" Margin="15,0" VerticalAlignment="Center">
                    <!-- Playback Speed -->
                    <TextBlock Text="SPEED:"
                              Foreground="{StaticResource AccentColor}"
                              FontSize="10"
                              FontWeight="Bold"
                              FontFamily="Consolas"
                              VerticalAlignment="Center"
                              Margin="0,0,8,0"/>
                    <ComboBox x:Name="SpeedComboBox"
                             Width="80"
                             FontSize="9"
                             Style="{StaticResource TechComboBox}"
                             VerticalAlignment="Center"
                             SelectionChanged="SpeedComboBox_SelectionChanged"
                             SelectedIndex="3">
                        <ComboBoxItem Content="0.25x" Tag="0.25" Style="{StaticResource TechComboBoxItem}"/>
                        <ComboBoxItem Content="0.5x" Tag="0.5" Style="{StaticResource TechComboBoxItem}"/>
                        <ComboBoxItem Content="0.75x" Tag="0.75" Style="{StaticResource TechComboBoxItem}"/>
                        <ComboBoxItem Content="1.0x" Tag="1.0" Style="{StaticResource TechComboBoxItem}"/>
                        <ComboBoxItem Content="1.25x" Tag="1.25" Style="{StaticResource TechComboBoxItem}"/>
                        <ComboBoxItem Content="1.5x" Tag="1.5" Style="{StaticResource TechComboBoxItem}"/>
                        <ComboBoxItem Content="2.0x" Tag="2.0" Style="{StaticResource TechComboBoxItem}"/>
                    </ComboBox>

                    <Border Width="1" Background="{StaticResource BorderColor}" Margin="15,0" Height="20"/>

                    <!-- Subtitle Size -->
                    <TextBlock Text="SUBTITLE SIZE:"
                              Foreground="{StaticResource AccentColor}"
                              FontSize="10"
                              FontWeight="Bold"
                              FontFamily="Consolas"
                              VerticalAlignment="Center"
                              Margin="0,0,8,0"/>
                    <ComboBox x:Name="SubtitleSizeComboBox"
                             Width="90"
                             FontSize="9"
                             Style="{StaticResource TechComboBox}"
                             VerticalAlignment="Center"
                             SelectionChanged="SubtitleSizeComboBox_SelectionChanged"
                             SelectedIndex="1">
                        <ComboBoxItem Content="SMALL" Tag="24" Style="{StaticResource TechComboBoxItem}"/>
                        <ComboBoxItem Content="MEDIUM" Tag="32" Style="{StaticResource TechComboBoxItem}"/>
                        <ComboBoxItem Content="LARGE" Tag="42" Style="{StaticResource TechComboBoxItem}"/>
                        <ComboBoxItem Content="XLARGE" Tag="54" Style="{StaticResource TechComboBoxItem}"/>
                    </ComboBox>

                    <Border Width="1" Background="{StaticResource BorderColor}" Margin="15,0" Height="20"/>

                    <!-- Rotation Controls -->
                    <TextBlock Text="ROTATE:"
                              Foreground="{StaticResource AccentColor}"
                              FontSize="10"
                              FontWeight="Bold"
                              FontFamily="Consolas"
                              VerticalAlignment="Center"
                              Margin="0,0,8,0"/>
                    <Button Content="↶ 90°" Click="RotateLeft_Click" Style="{StaticResource TechButton}"
                           Padding="8,4" Margin="2" FontSize="9" FontFamily="Consolas"/>
                    <Button Content="↷ 90°" Click="RotateRight_Click" Style="{StaticResource TechButton}"
                           Padding="8,4" Margin="2" FontSize="9" FontFamily="Consolas"/>
                    <Button Content="RESET" Click="RotateReset_Click" Style="{StaticResource TechButton}"
                           Padding="8,4" Margin="2" FontSize="9" FontFamily="Consolas"/>

                    <Border Width="1" Background="{StaticResource BorderColor}" Margin="15,0" Height="20"/>

                    <!-- Toggle Settings Button -->
                    <Button Content="[ CLOSE ]" Click="ToggleSettings_Click" Style="{StaticResource TechButton}"
                           Padding="12,4" Margin="2" FontSize="9" FontFamily="Consolas"/>
                </StackPanel>
            </Border>

            <!-- Video/Image Display -->
            <Grid x:Name="VideoContainer" Visibility="Collapsed" RenderTransformOrigin="0.5,0.5" MouseRightButtonDown="MediaContainer_MouseRightButtonDown">
                <Grid.LayoutTransform>
                    <RotateTransform x:Name="VideoRotateTransform" Angle="0"/>
                </Grid.LayoutTransform>
                <MediaElement x:Name="VideoPlayer"
                             LoadedBehavior="Manual"
                             UnloadedBehavior="Stop"
                             Stretch="Uniform"
                             Visibility="Visible"
                             MediaOpened="VideoPlayer_MediaOpened"
                             MediaEnded="VideoPlayer_MediaEnded"
                             MouseLeftButtonDown="Media_DoubleClick"
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center"/>
            </Grid>

            <Grid x:Name="ImageContainer" Visibility="Collapsed" RenderTransformOrigin="0.5,0.5" MouseRightButtonDown="MediaContainer_MouseRightButtonDown">
                <Grid.LayoutTransform>
                    <RotateTransform x:Name="ImageRotateTransform" Angle="0"/>
                </Grid.LayoutTransform>
                <Image x:Name="ImageViewer"
                      Stretch="Uniform"
                      Visibility="Visible"
                      MouseLeftButtonDown="Media_DoubleClick"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"/>
            </Grid>

            <Border x:Name="OSDPanel"
                   Background="#CC000000"
                   CornerRadius="0"
                   Padding="20,12"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Top"
                   Margin="0,40,0,0"
                   Visibility="Collapsed">
                <TextBlock x:Name="OSDText"
                          Text="OSD"
                          Foreground="White"
                          FontSize="24"
                          FontFamily="Consolas"
                          FontWeight="Bold"/>
            </Border>


            <Border x:Name="SubtitlePanel"
                   Background="#CC000000"
                   CornerRadius="0"
                   Padding="15,8"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Bottom"
                   Margin="0,0,0,80"
                   Visibility="Collapsed">
                <TextBlock x:Name="SubtitleText"
                          Text=""
                          Foreground="White"
                          FontSize="18"
                          FontFamily="Arial"
                          FontWeight="Bold"
                          TextAlignment="Center"
                          TextWrapping="Wrap"
                          MaxWidth="800"/>
            </Border>

            <!-- Welcome Screen -->
            <Border x:Name="WelcomeScreen"
                   Background="{StaticResource DarkBackground}"
                   Visibility="Visible">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <Border BorderBrush="{StaticResource BorderHighlight}" BorderThickness="3" Padding="25" CornerRadius="0" Margin="0,0,0,25">
                        <TextBlock Text="♪"
                                  FontSize="70"
                                  FontFamily="Segoe UI Symbol"
                                  Foreground="{StaticResource AccentColor}"
                                  HorizontalAlignment="Center"/>
                    </Border>
                    <TextBlock Text="BOB MEDIA PLAYER"
                              FontSize="36"
                              FontWeight="Bold"
                              FontFamily="Consolas"
                              Foreground="{StaticResource TextPrimary}"
                              HorizontalAlignment="Center"
                              Margin="0,0,0,8"/>
                    <TextBlock Text="alpha_2.0"
                              FontSize="11"
                              FontFamily="Consolas"
                              Foreground="{StaticResource AccentColor}"
                              HorizontalAlignment="Center"
                              Margin="0,0,0,30"/>
                    <TextBlock Text="DROP MEDIA FILES OR CLICK OPEN"
                              FontSize="12"
                              FontFamily="Consolas"
                              Foreground="{StaticResource TextSecondary}"
                              HorizontalAlignment="Center"
                              Margin="0,0,0,35"/>
                    <Button Content="[ OPEN MEDIA FILE ]"
                           Style="{StaticResource PlayButton}"
                           Click="OpenFile_Click"
                           Padding="35,14"
                           FontSize="13"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Control Panel -->
        <Border Grid.Row="1"
               x:Name="ControlPanel"
               Background="{StaticResource DarkSecondary}"
               BorderBrush="{StaticResource BorderHighlight}"
               BorderThickness="0,2,0,0"
               Padding="30,25">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Timeline -->
                <Grid x:Name="TimelinePanel" Grid.Row="0" Margin="0,0,0,18">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock x:Name="CurrentTimeText"
                              Grid.Column="0"
                              Text="00:00"
                              Foreground="{StaticResource TextSecondary}"
                              VerticalAlignment="Center"
                              Margin="0,0,18,0"
                              FontFamily="Consolas"
                              FontSize="13"
                              FontWeight="SemiBold"/>

                    <Slider x:Name="TimelineSlider"
                           Grid.Column="1"
                           Minimum="0"
                           Maximum="100"
                           Style="{StaticResource niceslide}"
                           VerticalAlignment="Center"
                           Thumb.DragStarted="TimelineSlider_DragStarted"
                           Thumb.DragCompleted="TimelineSlider_DragCompleted"
                           ValueChanged="TimelineSlider_ValueChanged"
                           PreviewMouseLeftButtonDown="TimelineSlider_MouseDown"/>

                    <TextBlock x:Name="TotalTimeText"
                              Grid.Column="2"
                              Text="00:00"
                              Foreground="{StaticResource TextSecondary}"
                              VerticalAlignment="Center"
                              Margin="18,0,0,0"
                              FontFamily="Consolas"
                              FontSize="13"
                              FontWeight="SemiBold"/>
                </Grid>

                <!-- Media Info -->
                <TextBlock x:Name="MediaInfoText"
                          Grid.Row="1"
                          Text="No media loaded"
                          Foreground="{StaticResource TextPrimary}"
                          FontSize="13"
                          FontWeight="SemiBold"
                          FontFamily="Segoe UI"
                          Margin="0,0,0,18"
                          TextTrimming="CharacterEllipsis"/>

                <!-- Control Buttons -->
                <StackPanel x:Name="ControlButtonsPanel" Grid.Row="2"
                           Orientation="Horizontal"
                           HorizontalAlignment="Center">
                    <Button x:Name="OpenButton"
                           Content="[ OPEN ]"
                           Style="{StaticResource TechButton}"
                           Click="OpenFile_Click"
                           Margin="6"
                           Padding="20,11"
                           FontSize="11"/>

                    <Button x:Name="PreviousButton"
                           Content="[ PREVIOUS ]"
                           Style="{StaticResource TechButton}"
                           Click="Previous_Click"
                           Margin="6"
                           Padding="16,11"
                           FontFamily="Consolas"
                           FontSize="11"
                           IsEnabled="False"/>

                    <Button x:Name="JumpBackButton"
                           Content="[ -10s ]"
                           Style="{StaticResource TechButton}"
                           Click="JumpBack_Click"
                           Margin="6"
                           Padding="14,11"
                           FontFamily="Consolas"
                           FontSize="11"
                           IsEnabled="False"/>

                    <Button x:Name="PlayPauseButton"
                           Content="[ PLAY ]"
                           Style="{StaticResource PlayButton}"
                           Click="PlayPause_Click"
                           Margin="6"
                           Padding="20,11"
                           FontFamily="Consolas"
                           FontSize="11"
                           IsEnabled="False"/>

                    <Button x:Name="JumpForwardButton"
                           Content="[ +10s ]"
                           Style="{StaticResource TechButton}"
                           Click="JumpForward_Click"
                           Margin="6"
                           Padding="14,11"
                           FontFamily="Consolas"
                           FontSize="11"
                           IsEnabled="False"/>

                    <Button x:Name="NextButton"
                           Content="[ NEXT ]"
                           Style="{StaticResource TechButton}"
                           Click="Next_Click"
                           Margin="6"
                           Padding="16,11"
                           FontFamily="Consolas"
                           FontSize="11"
                           IsEnabled="False"/>

                    <Border x:Name="SeparatorAfterNav" Width="2"
                           Background="{StaticResource BorderHighlight}"
                           Margin="18,0"/>

                    <Button x:Name="FullscreenButton"
                           Content="⛶"
                           Style="{StaticResource TechButton}"
                           Click="Fullscreen_Click"
                           Margin="6"
                           Padding="16,11"
                           FontFamily="Segoe UI Symbol"
                           FontSize="16"
                           IsEnabled="False"/>

                    <Button x:Name="SubtitleButton"
                           Content="[ SUBTITLE ]"
                           Style="{StaticResource TechButton}"
                           Click="Subtitle_Click"
                           Margin="6"
                           Padding="16,11"
                           FontFamily="Consolas"
                           FontSize="11"
                           IsEnabled="False"/>

                    <Border x:Name="SeparatorBeforeVolume" Width="2"
                           Background="{StaticResource BorderHighlight}"
                           Margin="18,0"/>

                    <StackPanel x:Name="VolumePanel" Orientation="Horizontal" VerticalAlignment="Center" Margin="18,0,0,0">
                        <TextBlock Text="VOL"
                                  FontSize="11"
                                  FontFamily="Consolas"
                                  FontWeight="Bold"
                                  Foreground="{StaticResource TextSecondary}"
                                  VerticalAlignment="Center"
                                  Margin="0,0,10,0"/>
                        <Slider x:Name="VolumeSlider"
                               Width="120"
                               Minimum="0"
                               Maximum="100"
                               Value="50"
                               VerticalAlignment="Center"
                               ValueChanged="VolumeSlider_ValueChanged"
                               Foreground="{StaticResource AccentColor}"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
